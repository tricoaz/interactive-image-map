<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive Image Map</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      display: flex;
      align-items: flex-start;
      justify-content: center;
    }
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }
    area {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div style="width:100%;">
    <img id="image-map" src="https://raw.githubusercontent.com/tricoaz/interactive-image-map/main/interactive-menu-07-2025.jpg" usemap="#image-map" border="0" width="100%" alt="" />
     <map name="image-map">
      <area alt="Brillit" title="Brillit"
  href="https://app.powerbi.com/reportEmbed?reportId=8955f405-3aff-4da5-a62b-6bde648978dd&autoAuth=true&ctid=63519a44-9837-48b5-8da3-83b39d0bbede"
  coords="343,248,887,644" shape="rect">
      <area alt="Photos" title="Photos" href="https://trico1.sharepoint.com/:u:/r/sites/TricoElectricCooperative/SitePages/Employee-Photos.aspx" coords="1951,889,343" shape="circle">
      <area alt="Safety Information" title="Safety Information"
  href="https://trico1.sharepoint.com/sites/TricoElectricCooperative/SitePages/Safety.aspx"
  coords="1893,139,2647,428" shape="rect">
      <area alt="Human Resources" title="Human Resources"
  href="https://trico1.sharepoint.com/:u:/r/sites/TricoElectricCooperative/SitePages/Human-Resources-%26-Safety.aspx?csf=1&web=1&share=ETvX-lCQWIhOqhfJAJZtri0B77x3fZ7HmRVELK0X1Lzm7w&e=p5oZ0h"
  coords="2078,459,2744,739" shape="rect">
      <area alt="Graphic Standards" title="Graphic Standards"
  href="https://trico1.sharepoint.com/sites/TricoElectricCooperative/SitePages/Graphic-Standards.aspx"
  coords="2085,778,2749,1055" shape="rect">
      <area alt="Cyber Security" title="Cyber Security" href="https://trico1.sharepoint.com/sites/TricoElectricCooperative/SitePages/Guidelines-and-documents-for-online-safety-and-data-protection.aspx" coords="2234,1269,2989,1600" shape="rect">
    </map>
  </div>

  <script>
  (function () {
    // --- Image map resizer (fast + bfcache-safe) ---
    function mapResizer(maps) {
      if (!maps) maps = document.getElementsByTagName('map');

      // Cache original coordinates once (in natural image coordinate space)
      for (const map of maps) {
        map.img = document.querySelector(`[usemap="#${map.name}"]`);
        map.areas = map.getElementsByTagName('area');

        for (const area of map.areas) {
          let arr = (area.coords || "")
            .split(',')
            .map(n => parseInt(n, 10))
            .filter(n => !Number.isNaN(n));

          // Normalize rect coords so left/top always come first
          if (area.shape && area.shape.toLowerCase() === 'rect' && arr.length === 4) {
            const left = Math.min(arr[0], arr[2]);
            const top = Math.min(arr[1], arr[3]);
            const right = Math.max(arr[0], arr[2]);
            const bottom = Math.max(arr[1], arr[3]);
            arr = [left, top, right, bottom];
          }

          area._coordArr = arr; // store original coords
        }
      }

      function resizeMaps() {
        for (const map of maps) {
          if (!map.img || !map.img.naturalWidth) continue;

          const scale = map.img.offsetWidth / map.img.naturalWidth;

          for (const area of map.areas) {
            if (!area._coordArr || area._coordArr.length === 0) continue;
            area.coords = area._coordArr.map(c => Math.round(c * scale)).join(',');
          }
        }
      }

      // Run twice to catch iframe/layout settling
      function runResizeTwice() {
        resizeMaps();
        setTimeout(resizeMaps, 250);
      }

      // If image isn't ready yet, wait for it
      for (const map of maps) {
        if (map.img && !map.img.complete) {
          map.img.addEventListener('load', runResizeTwice, { once: true });
        }
      }

      window.addEventListener('resize', resizeMaps);
      window.addEventListener('load', runResizeTwice);

      // Key for Back button (bfcache restore)
      window.addEventListener('pageshow', runResizeTwice);

      // Run now (after a short delay so SharePoint iframe can size)
      setTimeout(runResizeTwice, 150);
    }

    // --- Break out of iframe on click (bfcache-safe) ---
    function bindAreaLinks() {
      document.querySelectorAll('area[href]').forEach(area => {
        if (area.dataset.bound === "1") return; // prevent double-binding
        area.dataset.bound = "1";

        area.addEventListener('click', (e) => {
          e.preventDefault();
          window.top.location.href = area.href;
        }, true);
      });
    }

    // Init
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        mapResizer();
        bindAreaLinks();
      });
    } else {
      mapResizer();
      bindAreaLinks();
    }

    // Ensure links still work after Back/Forward restore
    window.addEventListener('pageshow', bindAreaLinks);
  })();
</script>
</body>
</html>
